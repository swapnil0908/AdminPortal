{"ast":null,"code":"var util = require(\"util\");\n\nvar querystring = require(\"querystring\");\n\nvar BaseClient = require(\"./client\");\n\nvar extend = require(\"./extend\");\n\nfunction AutomateClient(settings) {\n  this.server = {\n    host: \"api.browserstack.com\"\n  };\n  BaseClient.call(this, settings);\n}\n\nutil.inherits(AutomateClient, BaseClient); // public API\n\nextend(AutomateClient.prototype, {\n  getPlan: function getPlan(fn) {\n    this.request({\n      path: this.path(\"/plan.json\")\n    }, fn);\n  },\n  getBrowsers: function getBrowsers(fn) {\n    this.request({\n      path: this.path(\"/browsers.json\")\n    }, fn);\n  },\n  getProjects: function getProjects(fn) {\n    this.request({\n      path: this.path(\"/projects.json\")\n    }, this.handleResponse(fn, this.stripChildKeys(\"automation_project\")));\n  },\n  getProject: function getProject(id, fn) {\n    this.request({\n      path: this.path(\"/projects/\" + id + \".json\")\n    }, this.handleResponse(fn, function (project) {\n      project = project.project;\n      project.builds = this.stripChildKeys(\"automation_build\")(project.builds);\n      return project;\n    }.bind(this)));\n  },\n  getBuilds: function getBuilds(options, fn) {\n    if (typeof options === \"function\") {\n      fn = options;\n      options = {};\n    }\n\n    this.request({\n      path: this.path(\"/builds.json?\" + querystring.stringify(options))\n    }, this.handleResponse(fn, this.stripChildKeys(\"automation_build\")));\n  },\n  getSessions: function getSessions(buildId, options, fn) {\n    if (typeof fn === \"undefined\") {\n      fn = options;\n      options = {};\n    }\n\n    this.request({\n      path: this.path(\"/builds/\" + buildId + \"/sessions.json?\" + querystring.stringify(options))\n    }, this.handleResponse(fn, this.stripChildKeys(\"automation_session\")));\n  },\n  getSession: function getSession(id, fn) {\n    this.request({\n      path: this.path(\"/sessions/\" + id + \".json\")\n    }, this.handleResponse(fn, this.stripKey(\"automation_session\")));\n  },\n  updateSession: function updateSession(id, options, fn) {\n    var data = JSON.stringify(options);\n    this.request({\n      method: \"PUT\",\n      path: this.path(\"/sessions/\" + id + \".json\")\n    }, data, this.handleResponse(fn, this.stripKey(\"automation_session\")));\n  },\n  deleteSession: function deleteSession(id, fn) {\n    this.request({\n      method: \"DELETE\",\n      path: this.path(\"/sessions/\" + id + \".json\")\n    }, fn);\n  }\n}); // internal API\n\nextend(AutomateClient.prototype, {\n  path: function path(_path) {\n    return \"/automate\" + _path;\n  },\n  handleResponse: function handleResponse(fn, modifier) {\n    return function (error, data) {\n      if (error) {\n        return fn(error);\n      }\n\n      fn(null, modifier(data));\n    };\n  },\n  stripKey: function stripKey(key) {\n    return function (item) {\n      return item[key];\n    };\n  },\n  stripChildKeys: function stripChildKeys(key) {\n    return function (items) {\n      return items.map(function (item) {\n        return item[key];\n      });\n    };\n  }\n});\nmodule.exports = {\n  createClient: function createClient(settings) {\n    return new AutomateClient(settings);\n  }\n};","map":null,"metadata":{},"sourceType":"script"}